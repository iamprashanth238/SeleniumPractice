<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Selenium Automation Practice Site - Enhanced Registration</title>
    <style>
        :root { --primary: #4a90e2; --bg: #f4f4f9; --text: #333; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); display: flex; justify-content: center; min-height: 100vh; margin: 0; }
        .container { width: 100%; max-width: 1000px; background: white; margin: 20px; padding: 30px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h1, h2, h3 { color: var(--primary); }
        .view { display: none; }
        .active-view { display: block; }
        .form-group { margin-bottom: 12px; }
        label { display: block; margin-bottom: 6px; font-weight: bold; }
        input, select, textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
        input[type="radio"], input[type="checkbox"], input[type="file"] { width: auto; display: inline-block; margin-right: 8px; }
        .inline { display: inline-block; vertical-align: middle; margin-right: 12px; }
        .actions { margin-top: 10px; }
        button { background: var(--primary); color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background: #357abd; }
        button.secondary { background: #6c757d; }
        .practice-section { border: 1px solid #e0e0e0; padding: 15px; margin-bottom: 20px; border-radius: 4px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background: var(--primary); color: white; }
        .hidden { display: none; }
        #feedback { margin-top: 10px; padding: 10px; border-radius: 4px; text-align: center; }
        .success { background: #d4edda; color: #155724; padding: 10px; border-radius: 4px; }
        .error { background: #f8d7da; color: #721c24; padding: 10px; border-radius: 4px; }
        .small-note { font-size: 0.85rem; color: #666; margin-top: 8px; }
    </style>
</head>
<body>

<div class="container">
    <header style="display:flex; justify-content:space-between; align-items:center; border-bottom: 2px solid #eee; margin-bottom: 20px;">
        <h1>Automation Hub</h1>
        <div id="user-info" class="hidden">
            Welcome, <span id="display-username" style="font-weight:bold;">User</span> 
            <button id="logout-btn" class="secondary" style="margin-left: 10px;">Logout</button>
        </div>
    </header>

    <div id="login-view" class="view active-view">
        <h2>Login</h2>
        <div class="form-group">
            <label for="login-username">Username</label>
            <input type="text" id="login-username" placeholder="Enter username" />
        </div>
        <div class="form-group">
            <label for="login-password">Password</label>
            <input type="password" id="login-password" placeholder="Enter password" />
        </div>
        <button id="login-btn">Login</button>
        <p>Don't have an account? <a href="#" id="go-to-register">Register here</a></p>
        <div id="login-feedback"></div>
        <div class="small-note">Default: <code>admin</code> / <code>admin123</code></div>
    </div>

    <div id="register-view" class="view">
        <h2>Register New User</h2>
        <form id="register-form" enctype="multipart/form-data">
            <div class="form-group">
                <label for="reg-name">Full Name</label>
                <input type="text" id="reg-name" name="reg-name" required />
            </div>

            <div class="form-group">
                <label for="reg-username">Username</label>
                <input type="text" id="reg-username" name="reg-username" required />
            </div>

            <div class="form-group">
                <label for="reg-email">Email</label>
                <input type="email" id="reg-email" name="reg-email" required />
            </div>

            <div class="form-group">
                <label for="reg-password">Password</label>
                <input type="password" id="reg-password" name="reg-password" required />
            </div>

            <div class="form-group">
                <label>Gender</label>
                <span class="inline"><input type="radio" id="gender-male" name="reg-gender" value="Male" /> <label for="gender-male" style="display:inline; font-weight:normal;">Male</label></span>
                <span class="inline"><input type="radio" id="gender-female" name="reg-gender" value="Female" /> <label for="gender-female" style="display:inline; font-weight:normal;">Female</label></span>
                <span class="inline"><input type="radio" id="gender-other" name="reg-gender" value="Other" /> <label for="gender-other" style="display:inline; font-weight:normal;">Other</label></span>
            </div>

            <div class="form-group">
                <label for="reg-role">Role</label>
                <select id="reg-role" name="reg-role">
                    <option value="User">User</option>
                    <option value="Editor">Editor</option>
                    <option value="Moderator">Moderator</option>
                    <option value="Admin">Admin</option>
                </select>
            </div>

            <div class="form-group">
                <label for="reg-phone">Phone</label>
                <input type="tel" id="reg-phone" name="reg-phone" placeholder="+91 98765 43210" />
            </div>

            <div class="form-group">
                <label for="reg-website">Website (optional)</label>
                <input type="url" id="reg-website" name="reg-website" placeholder="https://example.com" />
            </div>

            <div class="form-group">
                <label for="reg-bio">Short Bio</label>
                <textarea id="reg-bio" name="reg-bio" rows="3" placeholder="Tell us something about yourself..."></textarea>
            </div>

            <div class="form-group">
                <label for="reg-profile-pic">Profile Picture (optional)</label>
                <input type="file" id="reg-profile-pic" name="reg-profile-pic" accept="image/*" />
                <div class="small-note">(File field is included for practice â€” file contents are not uploaded; filename is saved if available.)</div>
            </div>

            <div class="form-group">
                <input type="checkbox" id="terms-check" name="terms-check" /> <label for="terms-check" style="display:inline; font-weight:normal;"> I agree to the <a href="#" id="terms-link" target="_blank">Terms &amp; Privacy</a></label>
            </div>

            <div class="form-group">
                <input type="checkbox" id="newsletter-check" name="newsletter-check" /> <label for="newsletter-check" style="display:inline; font-weight:normal;"> Subscribe to newsletter</label>
            </div>

            <div class="actions">
                <button type="submit" id="register-btn">Register</button>
                <button type="button" class="secondary" id="back-to-login">Back</button>
                <button type="button" id="fill-sample" class="secondary" style="margin-left:8px;">Fill Sample Data</button>
            </div>

            <div id="register-feedback" style="margin-top:10px;"></div>
        </form>
    </div>

    <div id="dashboard-view" class="view">
        <h2>Practice Dashboard</h2>

        <div class="practice-section">
            <h3>1. Web Table (User Database)</h3>
            <p>New registrations will appear here instantly.</p>
            <table id="user-table">
                <thead>
                    <tr>
                        <th>ID</th><th>Name</th><th>Username</th><th>Email</th><th>Role</th><th>Gender</th><th>Phone</th><th>Action</th>
                    </tr>
                </thead>
                <tbody id="table-body"></tbody>
            </table>
            <button id="reset-data-btn" class="secondary" style="margin-top:10px; font-size:0.8rem;">Reset to Default Data</button>
        </div>

        <div class="practice-section">
            <h3>2. Dynamic Waits</h3>
            <button id="timer-btn">Start 5s Timer</button>
            <p id="timer-result" class="hidden" style="color:green; font-weight:bold;">Element Loaded Successfully!</p>
        </div>

        <div class="practice-section">
            <h3>3. Alerts</h3>
            <button onclick="alert('Alert Box')" id="alert-btn">Alert</button>
            <button onclick="confirm('Confirm Box')" id="confirm-btn">Confirm</button>
        </div>

        <div class="practice-section">
            <h3>4. Mouse Hover</h3>
            <button id="hover-btn" title="Tooltip Text">Hover Over Me</button>
        </div>

    </div>
</div>

<script>
    // --- 1. DATA MANAGEMENT WITH LOCAL STORAGE ---
    const defaultUsers = [
        { id: 1, name: "Admin User", username: "admin", email: "admin@example.com", password: "admin123", role: "Admin", gender: "Male", phone: "+911234567890" },
        { id: 2, name: "John Doe", username: "john.doe", email: "john@example.com", password: "password123", role: "User", gender: "Male", phone: "" },
        { id: 3, name: "Jane Smith", username: "jane.s", email: "jane@example.com", password: "securepass", role: "User", gender: "Female", phone: "" }
        // More default users omitted for brevity...
    ];

    function loadUsers() {
        const stored = localStorage.getItem('selenium_users');
        if (stored) return JSON.parse(stored);
        return JSON.parse(JSON.stringify(defaultUsers)); // deep copy
    }

    function saveUsers(userList) {
        localStorage.setItem('selenium_users', JSON.stringify(userList));
    }

    let users = loadUsers();

    // --- 2. NAVIGATION ---
    function showView(viewId) {
        document.querySelectorAll('.view').forEach(el => el.classList.remove('active-view'));
        document.getElementById(viewId).classList.add('active-view');

        // Clear inputs when switching to login/register to avoid stale values
        if (viewId === 'login-view' || viewId === 'register-view') {
            // selectively clear form fields (but keep localStorage data)
            document.querySelectorAll('#register-form input, #register-form textarea, #register-form select').forEach(i => {
                if (i.type !== 'checkbox' && i.type !== 'radio' && i.type !== 'file') i.value = '';
                if (i.type === 'checkbox') i.checked = false;
            });
            document.querySelectorAll('#register-form input[type="radio"]').forEach(r => r.checked = false);
            document.getElementById('login-feedback').innerHTML = '';
            document.getElementById('register-feedback').innerHTML = '';
        }
    }

    document.getElementById('go-to-register').addEventListener('click', (e) => { e.preventDefault(); showView('register-view'); });
    document.getElementById('back-to-login').addEventListener('click', () => showView('login-view'));
    document.getElementById('logout-btn').addEventListener('click', () => {
        document.getElementById('user-info').classList.add('hidden');
        showView('login-view');
    });

    // --- 3. LOGIN LOGIC ---
    document.getElementById('login-btn').addEventListener('click', () => {
        users = loadUsers(); // refresh
        const uVal = document.getElementById('login-username').value.trim();
        const pVal = document.getElementById('login-password').value;
        const feedback = document.getElementById('login-feedback');
        const user = users.find(u => u.username === uVal && u.password === pVal);

        if (user) {
            feedback.innerHTML = '<div class="success">Login Successful! Redirecting...</div>';
            setTimeout(() => {
                document.getElementById('user-info').classList.remove('hidden');
                document.getElementById('display-username').innerText = user.name;
                populateTable();
                showView('dashboard-view');
            }, 600);
        } else {
            feedback.innerHTML = '<div class="error">Invalid username or password</div>';
        }
    });

    // --- 4. REGISTRATION LOGIC (enhanced) ---
    document.getElementById('register-form').addEventListener('submit', (e) => {
        e.preventDefault();
        users = loadUsers(); // refresh

        const newName = document.getElementById('reg-name').value.trim();
        const newUsername = document.getElementById('reg-username').value.trim();
        const newEmail = document.getElementById('reg-email').value.trim();
        const newPass = document.getElementById('reg-password').value;
        // gender radios
        const genderNode = document.querySelector('input[name="reg-gender"]:checked');
        const newGender = genderNode ? genderNode.value : '';
        const newRole = document.getElementById('reg-role').value;
        const newPhone = document.getElementById('reg-phone').value.trim();
        const newWebsite = document.getElementById('reg-website').value.trim();
        const newBio = document.getElementById('reg-bio').value.trim();
        const newProfileInput = document.getElementById('reg-profile-pic');
        const newProfileFileName = newProfileInput.files && newProfileInput.files.length ? newProfileInput.files[0].name : '';

        const feedback = document.getElementById('register-feedback');

        // Basic validations
        if (!newName || !newUsername || !newEmail || !newPass) {
            feedback.innerHTML = '<div class="error">Please fill Name, Username, Email and Password.</div>';
            return;
        }

        if (!document.getElementById('terms-check').checked) {
            feedback.innerHTML = '<div class="error">You must agree to the terms to register.</div>';
            return;
        }

        // Check duplicates
        if (users.some(u => u.username.toLowerCase() === newUsername.toLowerCase())) {
            feedback.innerHTML = '<div class="error">Username already exists! Try another.</div>';
            return;
        }

        if (users.some(u => u.email && u.email.toLowerCase() === newEmail.toLowerCase())) {
            feedback.innerHTML = '<div class="error">Email already registered! Try another.</div>';
            return;
        }

        // Create object
        const newUserObj = {
            id: (users.length ? users[users.length - 1].id + 1 : 1),
            name: newName,
            username: newUsername,
            email: newEmail,
            password: newPass,
            role: newRole,
            gender: newGender,
            phone: newPhone,
            website: newWebsite,
            bio: newBio,
            profileFileName: newProfileFileName,
            newsletter: !!document.getElementById('newsletter-check').checked
        };

        users.push(newUserObj);
        saveUsers(users);

        console.log("New User Registered:", newUserObj);
        console.table(users);

        feedback.innerHTML = '<div class="success">Registration Successful! Redirecting to Login...</div>';
        setTimeout(() => {
            showView('login-view');
        }, 1200);
    });

    // Fill sample data button (useful for testing)
    document.getElementById('fill-sample').addEventListener('click', () => {
        document.getElementById('reg-name').value = "Selenium Tester";
        document.getElementById('reg-username').value = "selenium.tester";
        document.getElementById('reg-email').value = "tester@example.com";
        document.getElementById('reg-password').value = "Test@1234";
        document.getElementById('gender-male').checked = true;
        document.getElementById('reg-role').value = "User";
        document.getElementById('reg-phone').value = "+911234567890";
        document.getElementById('reg-website').value = "https://example.com";
        document.getElementById('reg-bio').value = "Automated-test account used for Selenium practice.";
        document.getElementById('terms-check').checked = true;
    });

    // --- 5. DASHBOARD FUNCTIONS ---
    function populateTable() {
        users = loadUsers();
        const tbody = document.getElementById('table-body');
        tbody.innerHTML = '';
        users.forEach(u => {
            // Sanitize display values
            const phone = u.phone ? u.phone : '';
            const email = u.email ? u.email : '';
            const gender = u.gender ? u.gender : '';
            const role = u.role ? u.role : '';
            tbody.innerHTML += `<tr>
                <td>${u.id}</td>
                <td>${escapeHtml(u.name)}</td>
                <td>${escapeHtml(u.username)}</td>
                <td>${escapeHtml(email)}</td>
                <td>${escapeHtml(role)}</td>
                <td>${escapeHtml(gender)}</td>
                <td>${escapeHtml(phone)}</td>
                <td>
                    <button class="secondary" onclick="alert('Deleting user ${u.id} is disabled')">Delete</button>
                </td>
            </tr>`;
        });
    }

    // Basic HTML escaper for table display
    function escapeHtml(text) {
        if (!text && text !== 0) return '';
        return String(text)
            .replaceAll('&', '&amp;')
            .replaceAll('<', '&lt;')
            .replaceAll('>', '&gt;')
            .replaceAll('"', '&quot;')
            .replaceAll("'", '&#039;');
    }

    document.getElementById('timer-btn').addEventListener('click', (e) => {
        e.target.disabled = true;
        e.target.innerText = "Loading...";
        setTimeout(() => {
            document.getElementById('timer-result').classList.remove('hidden');
            e.target.innerText = "Done";
        }, 5000);
    });

    document.getElementById('reset-data-btn').addEventListener('click', () => {
        localStorage.removeItem('selenium_users');
        users = JSON.parse(JSON.stringify(defaultUsers));
        saveUsers(users);
        populateTable();
        alert("Data reset to default users.");
    });

    // Initialize table on load
    populateTable();
</script>
</body>
</html>
